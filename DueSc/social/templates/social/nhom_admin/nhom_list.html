{% extends 'social/base.html' %}
{% load static %}

{% block title %}Danh sách nhóm - DUE Social{% endblock %}

{% block content %}
<div class="main-content flex">
    <!-- Phần danh sách nhóm bên trái -->
    <div class="w-2/3 p-4">
        <h2 class="text-2xl font-bold mb-4">Nhóm chờ duyệt</h2>

        <!-- Danh sách nhóm -->
        <div class="space-y-4">
            {% for group in pending_groups %}
            <div class="bg-white rounded-lg shadow p-4 flex items-center justify-between">
                <div class="flex items-center">
                    <div class="mr-4">
                        <img src="{% static 'image/avt.png' %}" alt="Nhóm" class="w-16 h-16 rounded-full">
                    </div>
                    <div class="flex-grow">
                        <h3 class="text-lg font-semibold">{{ group.ten_nhom }}</h3>
                        <p class="text-gray-500">Người tạo: {{ group.nguoi_tao.ho_ten }}</p>
                        <p class="text-gray-500">Mô tả: {{ group.mo_ta }}</p>
                    </div>
                </div>
                <div class="flex space-x-2">
                    <form method="post" action="{% url 'api_approve_group' group.id %}">
                        {% csrf_token %}
                        <button type="submit" class="px-4 py-2 bg-green-100 text-green-600 rounded-md hover:bg-green-200 transition">Duyệt</button>
                    </form>
                    <form method="post" action="{% url 'api_reject_group' group.id %}">
                        {% csrf_token %}
                        <button type="submit" class="px-4 py-2 bg-red-100 text-red-600 rounded-md hover:bg-red-200 transition">Từ chối</button>
                    </form>
                    <a href="{% url 'nhom_detail' group.id %}" class="px-4 py-2 bg-blue-100 text-blue-600 rounded-md hover:bg-blue-200 transition">Xem chi tiết</a>
                </div>
            </div>
            {% empty %}
            <p>Không có nhóm nào đang chờ duyệt.</p>
            {% endfor %}
        </div>
    </div>

    <!-- Phần nhóm đã tham gia và quản trị bên phải -->
    <div class="w-1/3 p-4">
        <div class="bg-white rounded-lg shadow p-4 mb-6">
            <h2 class="text-xl font-bold mb-4">Nhóm</h2>
            <div class="relative mb-4">
                <input type="text" placeholder="Tìm kiếm nhóm" class="w-full px-4 py-2 border rounded-lg">
                <span class="absolute right-3 top-2.5">
                    <i class="fas fa-search text-gray-400"></i>
                </span>
            </div>
        </div>

        <!-- Nhóm đã tham gia -->
        <div class="bg-white rounded-lg shadow p-4 mb-6">
            <div class="flex items-center justify-between mb-4">
                <div class="flex items-center">
                    <i class="fas fa-users mr-2"></i>
                    <h3 class="text-lg font-semibold">Nhóm đã tham gia</h3>
                </div>
                <a href="{% url 'nhom_da_tham_gia' %}" class="text-blue-600 hover:underline">Xem thêm</a>
            </div>

            <div class="space-y-4">
                {% for nhom in nguoi_dung.thanh_vien_nhom_set.all|slice:":2" %}
                <div class="flex items-center">
                    <img src="{% static 'image/avt.png' %}" alt="Nhóm" class="w-10 h-10 rounded-full mr-3">
                    <span>{{ nhom.ma_nhom.ten_nhom }}</span>
                </div>
                {% empty %}
                <p>Chưa tham gia nhóm nào.</p>
                {% endfor %}
            </div>
        </div>

        <!-- Nhóm làm quản trị viên -->
        <div class="bg-white rounded-lg shadow p-4">
            <div class="flex items-center justify-between mb-4">
                <div class="flex items-center">
                    <i class="fas fa-user-shield mr-2"></i>
                    <h3 class="text-lg font-semibold">Nhóm làm quản trị viên</h3>
                </div>
                <a href="{% url 'nhom_lam_qtrivien' %}" class="text-blue-600 hover:underline">Xem thêm</a>
            </div>

            <div class="space-y-4">
                {% for nhom in nguoi_dung.thanh_vien_nhom_set.filter|slice:":2" %}
                <div class="flex items-center">
                    <img src="{% static 'image/avt.png' %}" alt="Nhóm" class="w-10 h-10 rounded-full mr-3">
                    <span>{{ nhom.ma_nhom.ten_nhom }}</span>
                </div>
                {% empty %}
                <p>Chưa làm quản trị viên nhóm nào.</p>
                {% endfor %}
            </div>
        </div>
    </div>
</div>

<style>
.main-content {
    margin-left: 260px;
    background-color: #f0f2f5;
    min-height: 100vh;
}
</style>
{% endblock %}